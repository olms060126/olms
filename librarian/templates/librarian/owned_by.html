{% include 'librarian/lib_header.html' %}

<!--Books are owned by students-->
{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Owned By - {{ book.Book_name }}</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
</head>

<body class="bg-gray-100 min-h-screen p-6">

<div class="max-w-7xl mx-auto">

    <!-- HEADER -->
    <div class="bg-white shadow rounded-2xl p-6 mb-6">
        <h1 class="text-3xl font-bold text-gray-800">
            Book Details
        </h1>

        <div class="mt-4 grid grid-cols-1 md:grid-cols-3 gap-4 text-gray-700">
            <div>
                <p class="font-semibold">Book Name:</p>
                <p>{{ book.Book_name }}</p>
            </div>

            <div>
                <p class="font-semibold">ISBN:</p>
                <p>{{ book.ISBN }}</p>
            </div>

            <div>
                <p class="font-semibold">Author:</p>
                <p>{{ book.Authors_name}}</p>
            </div>
        </div>
    </div>


    <!-- CURRENT HOLDERS TABLE -->
    <div class="bg-white shadow rounded-2xl p-6">
        <h2 class="text-2xl font-bold text-gray-800 mb-4">
            Currently Owned By
        </h2>

        {% if transactions %}
        <div class="overflow-x-auto">
            <table class="min-w-full border border-gray-200 rounded-lg overflow-hidden">
                <thead class="bg-gray-200">
                    <tr>
                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Sl.No</th>
                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Student Name</th>
                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Roll No</th>
                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Access No</th>
                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Issued Date</th>
                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Due Date</th>
                    </tr>
                </thead>

                <tbody class="divide-y divide-gray-200">

                {% for transaction in transactions %}
                    <tr class="hover:bg-gray-50">
                        <td class="px-4 py-3">{{ forloop.counter }}</td>
                        <td class="px-4 py-3">
                            {{ transaction.Owned_by.Name }}
                        </td>
                        <td class="px-4 py-3">
                            {{ transaction.Owned_by.Roll_no }}
                        </td>
                        <td class="px-4 py-3">
                            {{ transaction.Access_no.id }}
                        </td>
                        <td class="px-4 py-3">
                            {{ transaction.issued_on|date:"d M Y" }}
                        </td>
                        <td class="px-4 py-3">
                            {{ transaction.Due_date|date:"d M Y" }}
                        </td>
                    </tr>
                {% endfor %}

                </tbody>
            </table>
        </div>

        {% else %}
            <div class="bg-green-100 text-green-800 p-4 rounded-lg">
                No copies of this book are currently issued.
            </div>
        {% endif %}
    </div>

</div>

</body>
</html>
