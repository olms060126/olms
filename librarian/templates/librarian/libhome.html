{% load static %}
{% include 'librarian/lib_header.html' %}

<!-- Tailwind -->
<script src="https://cdn.tailwindcss.com"></script>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<div class="min-h-screen bg-black text-white font-sans">

    <!-- Header -->
    <header class="border-b border-white/10 px-6 py-4 flex justify-between items-center">
        <h1 class="text-xl font-semibold tracking-wide">
            Librarian Dashboard
        </h1>
        <span class="text-sm text-white/60">
            {{ request.user.username|default:"Librarian" }}
        </span>
    </header>

    <!-- Main -->
    <main class="p-6 space-y-8">

        <!-- Stats Cards -->
        <section class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4">
            {% for label, value in stats %}
            <div class="bg-white text-black rounded-xl p-4 shadow">
                <p class="text-xs uppercase tracking-widest text-gray-500">
                    {{ label }}
                </p>
                <p class="text-2xl font-bold mt-2">
                    {{ value }}
                </p>
            </div>
           
            {%  empty %}
            <p> no static to show</p>
             {% endfor %}
        </section>


        <!-- Charts -->
        <section class="grid grid-cols-1 lg:grid-cols-2 gap-6">

            <!-- Book Availability Chart -->
            <div class="bg-white rounded-xl p-6 text-black">
                <h2 class="text-lg font-semibold mb-4">Book Availability</h2>

                <!-- Height controller -->
                <div class="relative w-full h-56 md:h-64 lg:h-72">
                    <canvas id="availabilityChart"></canvas>
                </div>
            </div>

            <!-- Usage Overview -->
            <div class="bg-white rounded-xl p-6 text-black">
                <h2 class="text-lg font-semibold mb-4">Library Usage</h2>

                <!-- Height controller -->
                <div class="relative w-full h-64 md:h-72 lg:h-80">
                    <canvas id="usageChart"></canvas>
                </div>
            </div>

        </section>


    </main>
</div>




<!-- Charts Script -->
<script>
  const availabilityChart = new Chart(
    document.getElementById('availabilityChart'),
    {
      type: 'pie',
      data: {
        labels: ['Available', 'Issued'],
        datasets: [{
          data: [
            {{ available_copies }},
            {{ issued_books }}
          ],
          borderWidth: 0
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,   // ðŸ”´ REQUIRED
        plugins: {
          legend: {
            position: 'right',
          }
        }
      }
    }
  );

  const usageChart = new Chart(
    document.getElementById('usageChart'),
    {
      type: 'bar',
      data: {
        labels: ['Books', 'Copies', 'Students', 'Reservations'],
        datasets: [{
          data: [
            {{ total_books }},
            {{ total_copies }},
            {{ total_students }},
            {{ pending_reservations }}
          ],
          borderRadius: 8
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,   // ðŸ”´ REQUIRED
        scales: {
          y: {
            beginAtZero: true
          }
        },
        plugins: {
          legend: { display: false }
        }
      }
    }
  );
</script>
